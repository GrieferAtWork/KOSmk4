/* Copyright (c) 2019-2024 Griefer@Work                                       *
 *                                                                            *
 * This software is provided 'as-is', without any express or implied          *
 * warranty. In no event will the authors be held liable for any damages      *
 * arising from the use of this software.                                     *
 *                                                                            *
 * Permission is granted to anyone to use this software for any purpose,      *
 * including commercial applications, and to alter it and redistribute it     *
 * freely, subject to the following restrictions:                             *
 *                                                                            *
 * 1. The origin of this software must not be misrepresented; you must not    *
 *    claim that you wrote the original software. If you use this software    *
 *    in a product, an acknowledgement (see the following) in the product     *
 *    documentation is required:                                              *
 *    Portions Copyright (c) 2019-2024 Griefer@Work                           *
 * 2. Altered source versions must be plainly marked as such, and must not be *
 *    misrepresented as being the original software.                          *
 * 3. This notice may not be removed or altered from any source distribution. *
 */

import * from deemon;

@@Known type classes for named (typedef'ed) types
global knownTypeClasses: {string: string} = Dict({
	"void"                   : "TV",
	"char"                   : "THH",
	"short"                  : "TH",
	"int"                    : "TD",
	"signed"                 : "TD",
	"unsigned"               : "TD",
	"bool"                   : "TD",
	"__BOOL"                 : "TD",
	"long"                   : "TL",
	"long long"              : "TLL",
	"long int long"          : "TLL",
	"__LONGLONG"             : "TLL",
	"__ULONGLONG"            : "TLL",
	"float"                  : "TF",
	"double"                 : "TFD",
	"long double"            : "TFL",
	"double long"            : "TFL",
	"__LONGDOUBLE"           : "TFL",
	"float _Complex"         : "TCF",
	"float complex"          : "TCF",
	"_Complex float"         : "TCF",
	"complex float"          : "TCF",
	"double _Complex"        : "TCFD",
	"double complex"         : "TCFD",
	"_Complex double"        : "TCFD",
	"complex double"         : "TCFD",
	"__LONGDOUBLE _Complex"  : "TCFL",
	"__LONGDOUBLE complex"   : "TCFL",
	"_Complex __LONGDOUBLE"  : "TCFL",
	"complex __LONGDOUBLE"   : "TCFL",
	"long double _Complex"   : "TCFL",
	"long double complex"    : "TCFL",
	"double long _Complex"   : "TCFL",
	"double long complex"    : "TCFL",
	"long _Complex double"   : "TCFL",
	"long complex double"    : "TCFL",
	"double _Complex long"   : "TCFL",
	"double complex long"    : "TCFL",
	"_Complex long double"   : "TCFL",
	"complex long double"    : "TCFL",
	"_Complex double long"   : "TCFL",
	"complex double long"    : "TCFL",
	"va_list"                : "TP",
	"__builtin_va_list"      : "TP",
	"size_t"                 : "TI",
	"__size_t"               : "TI",
	"ssize_t"                : "TI",
	"__ssize_t"              : "TI",
	"__SIZE_TYPE__"          : "TI",
	"__SSIZE_TYPE__"         : "TI",
	"intptr_t"               : "TP",
	"__intptr_t"             : "TP",
	"uintptr_t"              : "TP",
	"__uintptr_t"            : "TP",
	"longptr_t"              : "TP",
	"__longptr_t"            : "TP",
	"ulongptr_t"             : "TP",
	"__ulongptr_t"           : "TP",
	"__INTPTR_TYPE__"        : "TP",
	"__LONGPTR_TYPE__"       : "TP",
	"__UINTPTR_TYPE__"       : "TP",
	"__ULONGPTR_TYPE__"      : "TP",
	"__PTRDIFF_TYPE__"       : "TI",
	"__INTMAX_TYPE__"        : "TIn(__SIZEOF_INTMAX_T__)",
	"__UINTMAX_TYPE__"       : "TIn(__SIZEOF_INTMAX_T__)",
	"__BYTE_TYPE__"          : "TI8",
	"__SBYTE_TYPE__"         : "TI8",
	"__INT8_TYPE__"          : "TI8",
	"__INT16_TYPE__"         : "TI16",
	"__INT32_TYPE__"         : "TI32",
	"__INT64_TYPE__"         : "TI64",
	"__UINT8_TYPE__"         : "TI8",
	"__UINT16_TYPE__"        : "TI16",
	"__UINT32_TYPE__"        : "TI32",
	"__UINT64_TYPE__"        : "TI64",
	"__INT128_TYPE__"        : "TI128",
	"__UINT128_TYPE__"       : "TI128",
	"__CHAR_TYPE__"          : "TI8",
	"__CHAR8_TYPE__"         : "TI8",
	"char8_t"                : "TI8",
	"wchar_t"                : "TIn(__SIZEOF_WCHAR_T__)",
	"__wchar_t"              : "TIn(__SIZEOF_WCHAR_T__)",
	"__WCHAR_TYPE__"         : "TIn(__SIZEOF_WCHAR_T__)",
	"char16_t"               : "TI16",
	"__char16_t"             : "TI16",
	"__CHAR16_TYPE__"        : "TI16",
	"__WCHAR16_TYPE__"       : "TI16",
	"char32_t"               : "TI32",
	"__char32_t"             : "TI32",
	"__CHAR32_TYPE__"        : "TI32",
	"__WCHAR32_TYPE__"       : "TI32",
	"wint_t"                 : "TIn(__SIZEOF_WINT_T__)",
	"__wint_t"               : "TIn(__SIZEOF_WINT_T__)",
	"__WINT_TYPE__"          : "TIn(__SIZEOF_WINT_T__)",
	"wctype_t"               : "TIn(__SIZEOF_WCTYPE_T__)",
	"__wctype_t"             : "TIn(__SIZEOF_WCTYPE_T__)",
	"wctrans_t"              : "TIn(__SIZEOF_WCTRANS_T__)",
	"__wctrans_t"            : "TIn(__SIZEOF_WCTRANS_T__)",
	"sig_atomic_t"           : "TIn(__SIZEOF_SIG_ATOMIC_T__)",
	"__SIG_ATOMIC_TYPE__"    : "TIn(__SIZEOF_SIG_ATOMIC_T__)",
	"__INTSIZE_TYPE__"       : "TI",
	"__INTSSIZE_TYPE__"      : "TI",
	"__LONGSIZE_TYPE__"      : "TI",
	"__LONGSSIZE_TYPE__"     : "TI",
	"__LONG32_TYPE__"        : "TI32",
	"__ULONG32_TYPE__"       : "TI32",
	"__LONG64_TYPE__"        : "TI64",
	"__ULONG64_TYPE__"       : "TI64",
	"__BUSINT_TYPE__"        : "TIn(__SIZEOF_BUSINT__)",
	"__UBUSIINT_TYPE__"      : "TIn(__SIZEOF_BUSINT__)",
	"register_t"             : "TIn(__SIZEOF_REGISTER__)",
	"__register_t"           : "TIn(__SIZEOF_REGISTER__)",
	"sregister_t"            : "TIn(__SIZEOF_REGISTER__)",
	"__sregister_t"          : "TIn(__SIZEOF_REGISTER__)",
	"__REGISTER_TYPE__"      : "TIn(__SIZEOF_REGISTER__)",
	"__SREGISTER_TYPE__"     : "TIn(__SIZEOF_REGISTER__)",
	"__INT_LEAST8_TYPE__"    : "TIn(__SIZEOF_INT_LEAST8_T__)",
	"__INT_LEAST16_TYPE__"   : "TIn(__SIZEOF_INT_LEAST16_T__)",
	"__INT_LEAST32_TYPE__"   : "TIn(__SIZEOF_INT_LEAST32_T__)",
	"__INT_LEAST64_TYPE__"   : "TIn(__SIZEOF_INT_LEAST64_T__)",
	"__UINT_LEAST8_TYPE__"   : "TIn(__SIZEOF_INT_LEAST8_T__)",
	"__UINT_LEAST16_TYPE__"  : "TIn(__SIZEOF_INT_LEAST16_T__)",
	"__UINT_LEAST32_TYPE__"  : "TIn(__SIZEOF_INT_LEAST32_T__)",
	"__UINT_LEAST64_TYPE__"  : "TIn(__SIZEOF_INT_LEAST64_T__)",
	"__INT_FAST8_TYPE__"     : "TIn(__SIZEOF_INT_FAST8_T__)",
	"__INT_FAST16_TYPE__"    : "TIn(__SIZEOF_INT_FAST16_T__)",
	"__INT_FAST32_TYPE__"    : "TIn(__SIZEOF_INT_FAST32_T__)",
	"__INT_FAST64_TYPE__"    : "TIn(__SIZEOF_INT_FAST64_T__)",
	"__UINT_FAST8_TYPE__"    : "TIn(__SIZEOF_INT_FAST8_T__)",
	"__UINT_FAST16_TYPE__"   : "TIn(__SIZEOF_INT_FAST16_T__)",
	"__UINT_FAST32_TYPE__"   : "TIn(__SIZEOF_INT_FAST32_T__)",
	"__UINT_FAST64_TYPE__"   : "TIn(__SIZEOF_INT_FAST64_T__)",

	/* From <bits/types.h> */
	"fd_t"              : "TIn(__SIZEOF_FD_T__)",
	"__fd_t"            : "TIn(__SIZEOF_FD_T__)",
	"fcntl_t"           : "TIn(__SIZEOF_FCNTL_T__)",
	"__fcntl_t"         : "TIn(__SIZEOF_FCNTL_T__)",
	"ioctl_t"           : "TIn(__SIZEOF_IOCTL_T__)",
	"__ioctl_t"         : "TIn(__SIZEOF_IOCTL_T__)",
	"errno_t"           : "TIn(__SIZEOF_ERRNO_T__)",
	"__errno_t"         : "TIn(__SIZEOF_ERRNO_T__)",
	"signo_t"           : "TIn(__SIZEOF_SIGNO_T__)",
	"__signo_t"         : "TIn(__SIZEOF_SIGNO_T__)",
	"oflag_t"           : "TIn(__SIZEOF_OFLAG_T__)",
	"__oflag_t"         : "TIn(__SIZEOF_OFLAG_T__)",
	"syscall_slong_t"   : "TIn(__SIZEOF_SYSCALL_LONG_T__)",
	"__syscall_slong_t" : "TIn(__SIZEOF_SYSCALL_LONG_T__)",
	"syscall_ulong_t"   : "TIn(__SIZEOF_SYSCALL_LONG_T__)",
	"__syscall_ulong_t" : "TIn(__SIZEOF_SYSCALL_LONG_T__)",
	"mode_t"            : "TIn(__SIZEOF_MODE_T__)",
	"__mode_t"          : "TIn(__SIZEOF_MODE_T__)",
	"atflag_t"          : "TIn(__SIZEOF_ATFLAG_T__)",
	"__atflag_t"        : "TIn(__SIZEOF_ATFLAG_T__)",
	"iomode_t"          : "TIn(__SIZEOF_IOMODE_T__)",
	"__iomode_t"        : "TIn(__SIZEOF_IOMODE_T__)",
	"major_t"           : "TIn(__SIZEOF_MAJOR_T__)",
	"__major_t"         : "TIn(__SIZEOF_MAJOR_T__)",
	"minor_t"           : "TIn(__SIZEOF_MINOR_T__)",
	"__minor_t"         : "TIn(__SIZEOF_MINOR_T__)",
	"dev_t"             : "TIn(__SIZEOF_DEV_T__)",
	"__dev_t"           : "TIn(__SIZEOF_DEV_T__)",
	"id_t"              : "TIn(__SIZEOF_ID_T__)",
	"__id_t"            : "TIn(__SIZEOF_ID_T__)",
	"pid_t"             : "TIn(__SIZEOF_PID_T__)",
	"__pid_t"           : "TIn(__SIZEOF_PID_T__)",
	"key_t"             : "TIn(__SIZEOF_KEY_T__)",
	"__key_t"           : "TIn(__SIZEOF_KEY_T__)",
	"daddr_t"           : "TIn(__SIZEOF_DADDR_T__)",
	"__daddr_t"         : "TIn(__SIZEOF_DADDR_T__)",
	"caddr_t"           : "TIn(__SIZEOF_CADDR_T__)",
	"__caddr_t"         : "TIn(__SIZEOF_CADDR_T__)",
	"fsid_t"            : "TIn(__SIZEOF_FSID_T__)",
	"__fsid_t"          : "TIn(__SIZEOF_FSID_T__)",
	"blksize_t"         : "TIn(__SIZEOF_BLKSIZE_T__)",
	"__blksize_t"       : "TIn(__SIZEOF_BLKSIZE_T__)",
	"nlink_t"           : "TIn(__SIZEOF_NLINK_T__)",
	"__nlink_t"         : "TIn(__SIZEOF_NLINK_T__)",
	"off_t"             : "TIn(__SIZEOF_OFF_T__)",
	"__off_t"           : "TIn(__SIZEOF_OFF_T__)",
	"__FS_TYPE(off)"    : "TIn(__SIZEOF_OFF_T__)",
	"off32_t"           : "TIn(__SIZEOF_OFF32_T__)",
	"__off32_t"         : "TIn(__SIZEOF_OFF32_T__)",
	"off64_t"           : "TIn(__SIZEOF_OFF64_T__)",
	"__off64_t"         : "TIn(__SIZEOF_OFF64_T__)",
	"pos_t"             : "TIn(__SIZEOF_OFF_T__)",
	"__pos_t"           : "TIn(__SIZEOF_OFF_T__)",
	"__FS_TYPE(pos)"    : "TIn(__SIZEOF_OFF_T__)",
	"pos32_t"           : "TIn(__SIZEOF_OFF32_T__)",
	"__pos32_t"         : "TIn(__SIZEOF_OFF32_T__)",
	"pos64_t"           : "TIn(__SIZEOF_OFF64_T__)",
	"__pos64_t"         : "TIn(__SIZEOF_OFF64_T__)",
	"loff_t"            : "TIn(__SIZEOF_LOFF_T__)",
	"__loff_t"          : "TIn(__SIZEOF_LOFF_T__)",
	"blkcnt_t"          : "TIn(__SIZEOF_BLKCNT_T__)",
	"__FS_TYPE(blkcnt)" : "TIn(__SIZEOF_BLKCNT_T__)",
	"__blkcnt_t"        : "TIn(__SIZEOF_BLKCNT_T__)",
	"blkcnt32_t"        : "TIn(__SIZEOF_BLKCNT32_T__)",
	"__blkcnt32_t"      : "TIn(__SIZEOF_BLKCNT32_T__)",
	"blkcnt64_t"        : "TIn(__SIZEOF_BLKCNT64_T__)",
	"__blkcnt64_t"      : "TIn(__SIZEOF_BLKCNT64_T__)",
	"fsblkcnt_t"        : "TIn(__SIZEOF_FSBLKCNT_T__)",
	"__FS_TYPE(fsblkcnt)" : "TIn(__SIZEOF_FSBLKCNT_T__)",
	"__fsblkcnt_t"      : "TIn(__SIZEOF_FSBLKCNT_T__)",
	"fsblkcnt32_t"      : "TIn(__SIZEOF_FSBLKCNT32_T__)",
	"__fsblkcnt32_t"    : "TIn(__SIZEOF_FSBLKCNT32_T__)",
	"fsblkcnt64_t"      : "TIn(__SIZEOF_FSBLKCNT64_T__)",
	"__fsblkcnt64_t"    : "TIn(__SIZEOF_FSBLKCNT64_T__)",
	"fsfilcnt_t"        : "TIn(__SIZEOF_FSFILCNT_T__)",
	"__FS_TYPE(fsfilcnt)" : "TIn(__SIZEOF_FSFILCNT_T__)",
	"__fsfilcnt_t"      : "TIn(__SIZEOF_FSFILCNT_T__)",
	"fsfilcnt32_t"      : "TIn(__SIZEOF_FSFILCNT32_T__)",
	"__fsfilcnt32_t"    : "TIn(__SIZEOF_FSFILCNT32_T__)",
	"fsfilcnt64_t"      : "TIn(__SIZEOF_FSFILCNT64_T__)",
	"__fsfilcnt64_t"    : "TIn(__SIZEOF_FSFILCNT64_T__)",
	"ino_t"             : "TIn(__SIZEOF_INO_T__)",
	"__FS_TYPE(ino)"    : "TIn(__SIZEOF_INO_T__)",
	"__ino_t"           : "TIn(__SIZEOF_INO_T__)",
	"ino32_t"           : "TIn(__SIZEOF_INO32_T__)",
	"__ino32_t"         : "TIn(__SIZEOF_INO32_T__)",
	"ino64_t"           : "TIn(__SIZEOF_INO64_T__)",
	"__ino64_t"         : "TIn(__SIZEOF_INO64_T__)",
	"rlim_t"            : "TIn(__SIZEOF_RLIM_T__)",
	"__FS_TYPE(rlim)"   : "TIn(__SIZEOF_RLIM_T__)",
	"__rlim_t"          : "TIn(__SIZEOF_RLIM_T__)",
	"rlim32_t"          : "TIn(__SIZEOF_RLIM32_T__)",
	"__rlim32_t"        : "TIn(__SIZEOF_RLIM32_T__)",
	"rlim64_t"          : "TIn(__SIZEOF_RLIM64_T__)",
	"__rlim64_t"        : "TIn(__SIZEOF_RLIM64_T__)",
	"time_t"            : "TIn(__SIZEOF_TIME_T__)",
	"__time_t"          : "TIn(__SIZEOF_TIME_T__)",
	"__TM_TYPE(time)"   : "TIn(__SIZEOF_TIME_T__)",
	"time32_t"          : "TIn(__SIZEOF_TIME32_T__)",
	"__time32_t"        : "TIn(__SIZEOF_TIME32_T__)",
	"time64_t"          : "TIn(__SIZEOF_TIME64_T__)",
	"__time64_t"        : "TIn(__SIZEOF_TIME64_T__)",
	"socklen_t"         : "TIn(__SIZEOF_SOCKLEN_T__)",
	"__socklen_t"       : "TIn(__SIZEOF_SOCKLEN_T__)",
	"clock_t"           : "TIn(__SIZEOF_CLOCK_T__)",
	"__clock_t"         : "TIn(__SIZEOF_CLOCK_T__)",
	"useconds_t"        : "TIn(__SIZEOF_USECONDS_T__)",
	"__useconds_t"      : "TIn(__SIZEOF_USECONDS_T__)",
	"suseconds_t"       : "TIn(__SIZEOF_SUSECONDS_T__)",
	"__suseconds_t"     : "TIn(__SIZEOF_SUSECONDS_T__)",
	"clockid_t"         : "TIn(__SIZEOF_CLOCKID_T__)",
	"__clockid_t"       : "TIn(__SIZEOF_CLOCKID_T__)",
	"gid_t"             : "TIn(__SIZEOF_GID_T__)",
	"__gid_t"           : "TIn(__SIZEOF_GID_T__)",
	"uid_t"             : "TIn(__SIZEOF_UID_T__)",
	"__uid_t"           : "TIn(__SIZEOF_UID_T__)",
	"timer_t"           : "TIn(__SIZEOF_TIMER_T__)",
	"__timer_t"         : "TIn(__SIZEOF_TIMER_T__)",
	"fsword_t"          : "TIn(__SIZEOF_FSWORD_T__)",
	"__fsword_t"        : "TIn(__SIZEOF_FSWORD_T__)",
	"physaddr_t"        : "TIn(__SIZEOF_PHYSADDR_T__)",
	"__physaddr_t"      : "TIn(__SIZEOF_PHYSADDR_T__)",

	/* __STDC_x_AS_y types */
	"__STDC_INT_AS_SSIZE_T"   : "TD",
	"__STDC_INT_AS_SIZE_T"    : "TD",
	"__STDC_INT32_AS_SSIZE_T" : "TI32",
	"__STDC_INT32_AS_SIZE_T"  : "TI32",
	"__STDC_UINT_AS_SIZE_T"   : "TD",
	"__STDC_UINT32_AS_SIZE_T" : "TI32",
	"__STDC_INT_AS_UINT_T"    : "TD",
	"__STDC_LONG_AS_SIZE_T"   : "TL",

	/* Misc. types */
	"__le8"             : "TI8",
	"__le16"            : "TI16",
	"__le32"            : "TI32",
	"__le64"            : "TI64",
	"__be8"             : "TI8",
	"__be16"            : "TI16",
	"__be32"            : "TI32",
	"__be64"            : "TI64",
	"__u_net16_t"       : "TI16",
	"__u_net32_t"       : "TI32",
	"__u_net64_t"       : "TI64",
	"locale_t"          : "TP",
	"__locale_t"        : "TP",
});
