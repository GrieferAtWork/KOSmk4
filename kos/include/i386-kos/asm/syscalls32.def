/* Copyright (c) 2019 Griefer@Work                                            *
 *                                                                            *
 * This software is provided 'as-is', without any express or implied          *
 * warranty. In no event will the authors be held liable for any damages      *
 * arising from the use of this software.                                     *
 *                                                                            *
 * Permission is granted to anyone to use this software for any purpose,      *
 * including commercial applications, and to alter it and redistribute it     *
 * freely, subject to the following restrictions:                             *
 *                                                                            *
 * 1. The origin of this software must not be misrepresented; you must not    *
 *    claim that you wrote the original software. If you use this software    *
 *    in a product, an acknowledgement in the product documentation would be  *
 *    appreciated but is not required.                                        *
 * 2. Altered source versions must be plainly marked as such, and must not be *
 *    misrepresented as being the original software.                          *
 * 3. This notice may not be removed or altered from any source distribution. */

/* Delete all generic definitions from include/asm/syscalls.def */
%[clear_syscall_id_table]


@@Restore the specified register state when returning from a signal handler
@@Note that the order and locations of arguments taken by this system call
@@are of great importance, as they must match what is encoded by the kernel
@@within `sighand_raise_signal()'
@@The order chosen is also important, as it is selected such that arguments
@@are only passed through registers that are preserved by CDECL
[restart(must)][noexcept]
sigreturn:(struct fpustate const *restore_fpu, syscall_ulong_t unused1,
           syscall_ulong_t unused2, struct __sigset_struct const *restore_sigmask,
           struct rpc_syscall_info *sc_info, struct ucpustate const *restore_cpu);

clone:([tostr(flagset(CLONE_VM, CLONE_FS, CLONE_FILES, CLONE_SIGHAND, CLONE_PTRACE,
                      CLONE_VFORK, CLONE_PARENT, CLONE_THREAD, CLONE_NEWNS, CLONE_SYSVSEM,
                      CLONE_SETTLS, CLONE_PARENT_SETTID, CLONE_CHILD_CLEARTID, CLONE_DETACHED,
                      CLONE_UNTRACED, CLONE_CHILD_SETTID, CLONE_NEWUTS, CLONE_NEWIPC,
                      CLONE_NEWUSER, CLONE_NEWPID, CLONE_NEWNET, CLONE_IO))]
       syscall_ulong_t flags, void *child_stack,
       pid_t *ptid, uintptr_t newtls, pid_t *ctid) -> pid_t;

[cp] lchown:(char const *filename, uint16_t owner, uint16_t group) -> errno_t;
[cp] lchown32:(char const *filename, uint32_t owner, uint32_t group) -> errno_t;
[cp] fchown:(fd_t fd, uint16_t owner, uint16_t group) -> errno_t;
[cp] fchown32:(fd_t fd, uint32_t owner, uint32_t group) -> errno_t;
[cp] chown:(char const *filename, uint16_t owner, uint16_t group) -> errno_t;
[cp] chown32:(char const *filename, uint32_t owner, uint32_t group) -> errno_t;

[restart(must)] getuid:() -> uint16_t;
[restart(must)] getuid32:() -> uint32_t;
[restart(must)] setuid:(uint16_t uid) -> errno_t;
[restart(must)] setuid32:(uint32_t uid) -> errno_t;
[restart(must)] getgid:() -> uint16_t;
[restart(must)] getgid32:() -> uint32_t;
[restart(must)] setgid:(uint16_t gid) -> errno_t;
[restart(must)] setgid32:(uint32_t gid) -> errno_t;
[restart(must)] geteuid:() -> uint16_t;
[restart(must)] geteuid32:() -> uint32_t;
[restart(must)] setreuid:(uint16_t ruid, uint16_t euid) -> errno_t;
[restart(must)] setreuid32:(uint32_t ruid, uint32_t euid) -> errno_t;
[restart(must)] getegid:() -> uint16_t;
[restart(must)] getegid32:() -> uint32_t;
[restart(must)] setregid:(uint16_t rgid, uint16_t egid) -> errno_t;
[restart(must)] setregid32:(uint32_t rgid, uint32_t egid) -> errno_t;
[restart(must)] getresuid:(uint16_t *ruid, uint16_t *euid, uint16_t *suid) -> errno_t;
[restart(must)] getresuid32:(uint32_t *ruid, uint32_t *euid, uint32_t *suid) -> errno_t;
[restart(must)] setresuid:(uint16_t ruid, uint16_t euid, uint16_t suid) -> errno_t;
[restart(must)] setresuid32:(uint32_t ruid, uint32_t euid, uint32_t suid) -> errno_t;
[restart(must)] getresgid:(uint16_t *rgid, uint16_t *egid, uint16_t *sgid) -> errno_t;
[restart(must)] getresgid32:(uint32_t *rgid, uint32_t *egid, uint32_t *sgid) -> errno_t;
[restart(must)] setresgid:(uint16_t rgid, uint16_t egid, uint16_t sgid) -> errno_t;
[restart(must)] setresgid32:(uint32_t rgid, uint32_t egid, uint32_t sgid) -> errno_t;
[restart(must)] getgroups:(size_t size, uint16_t list[]) -> errno_t;
[restart(must)] getgroups32:(size_t size, uint32_t list[]) -> errno_t;
[restart(must)] setgroups:(size_t count, uint16_t const *groups) -> errno_t;
[restart(must)] setgroups32:(size_t count, uint32_t const *groups) -> errno_t;
[restart(must)] setfsuid:(uint16_t uid) -> errno_t;
[restart(must)] setfsuid32:(uint32_t uid) -> errno_t;
[restart(must)] setfsgid:(uint16_t gid) -> errno_t;
[restart(must)] setfsgid32:(uint32_t gid) -> errno_t;

@@@param: prot:  Either `PROT_NONE', or set of `PROT_EXEC|PROT_WRITE|PROT_READ|PROT_SEM|PROT_LOOSE|PROT_SHARED'
@@@param: flags: One of `MAP_SHARED`, 'MAP_SHARED_VALIDATE' or `MAP_PRIVATE', optionally or'd
@@              with a set of `MAP_ANONYMOUS|MAP_FIXED|MAP_GROWSDOWN|MAP_LOCKED|
@@              MAP_NONBLOCK|MAP_NORESERVE|MAP_POPULATE|MAP_STACK|MAP_SYNC|
@@              MAP_UNINITIALIZED|MAP_DONT_MAP|MAP_DONT_OVERRIDE|MAP_OFFSET64_POINTER'
mmap:(void *addr, size_t len,
	[tostr(flagset(
		PROT_NONE:
			PROT_EXEC, PROT_WRITE, PROT_READ,
			PROT_SEM, PROT_LOOSE, PROT_SHARED))]
		syscall_ulong_t prot,
	[tostr(flagset(MAP_AUTOMATIC:
		MAP_SHARED, MAP_PRIVATE, MAP_FIXED,
		MAP_ANON, MAP_32BIT, MAP_GROWSDOWN, MAP_GROWSUP,
		MAP_LOCKED, MAP_NORESERVE, MAP_POPULATE, MAP_NONBLOCK,
		MAP_STACK, MAP_UNINITIALIZED, MAP_DONT_MAP, MAP_DONT_OVERRIDE,
		MAP_OFFSET64_POINTER))]
		syscall_ulong_t flags, fd_t fd,
		syscall_ulong_t offset) -> void *;



/* Syscall definition syntax
 * >> sysno:name[:sys_name=name]
 * This is used as:
 * >> #define __NR_<name>     <sysno>     // In <asm/unistd.h>
 * >> #define SYS_<sys_name>  __NR_<name> // In <sys/syscall.h>
 * >> DEFINE_SYSCALLn(int, <name>, ...)   // Somewhere in kernel-space
 * >> int <name>(...);                    // In <kos/syscalls.h>
 */

0x00000000:restart_syscall
0x00000001:exit
0x00000002:fork
0x00000003:read
0x00000004:write
0x00000005:open
0x00000006:close
0x00000007:waitpid
0x00000008:creat
0x00000009:link
0x0000000a:unlink
0x0000000b:execve
0x0000000c:chdir
0x0000000d:time
0x0000000e:mknod
0x0000000f:chmod
0x00000010:lchown
0x00000011:break
0x00000012:linux_oldstat
0x00000013:lseek
0x00000014:getpid
0x00000015:mount
0x00000016:umount
0x00000017:setuid
0x00000018:getuid
0x00000019:stime
0x0000001a:ptrace
0x0000001b:alarm
0x0000001c:linux_oldfstat
0x0000001d:pause
0x0000001e:utime
0x0000001f:stty
0x00000020:gtty
0x00000021:access
0x00000022:nice
0x00000023:ftime
0x00000024:sync
0x00000025:kill
0x00000026:rename
0x00000027:mkdir
0x00000028:rmdir
0x00000029:dup
0x0000002a:pipe
0x0000002b:times
0x0000002c:prof
0x0000002d:brk
0x0000002e:setgid
0x0000002f:getgid
0x00000030:signal
0x00000031:geteuid
0x00000032:getegid
0x00000033:acct
0x00000034:umount2
0x00000035:lock
0x00000036:ioctl
0x00000037:fcntl
0x00000038:mpx
0x00000039:setpgid
0x0000003a:ulimit
0x0000003b:oldolduname
0x0000003c:umask
0x0000003d:chroot
0x0000003e:ustat
0x0000003f:dup2
0x00000040:getppid
0x00000041:getpgrp
0x00000042:setsid
0x00000043:sigaction
0x00000044:sgetmask
0x00000045:ssetmask
0x00000046:setreuid
0x00000047:setregid
0x00000048:sigsuspend
0x00000049:sigpending
0x0000004a:sethostname
0x0000004b:setrlimit
0x0000004c:getrlimit
0x0000004d:getrusage
0x0000004e:gettimeofday
0x0000004f:settimeofday
0x00000050:getgroups
0x00000051:setgroups
0x00000052:select
0x00000053:symlink
0x00000054:linux_oldlstat
0x00000055:readlink
0x00000056:uselib
0x00000057:swapon
0x00000058:reboot
0x00000059:readdir
0x0000005a:mmap
0x0000005b:munmap
0x0000005c:truncate
0x0000005d:ftruncate
0x0000005e:fchmod
0x0000005f:fchown
0x00000060:getpriority
0x00000061:setpriority
0x00000062:profil
0x00000063:statfs
0x00000064:fstatfs
0x00000065:ioperm
0x00000066:socketcall
0x00000067:syslog
0x00000068:setitimer
0x00000069:getitimer
0x0000006a:linux_stat32
0x0000006b:linux_lstat32
0x0000006c:linux_fstat32
0x0000006d:olduname
0x0000006e:iopl
0x0000006f:vhangup
0x00000070:idle
0x00000071:vm86old
0x00000072:wait4
0x00000073:swapoff
0x00000074:sysinfo
0x00000075:ipc
0x00000076:fsync
0x00000077:sigreturn
0x00000078:clone
0x00000079:setdomainname
0x0000007a:uname
0x0000007b:modify_ldt
0x0000007c:adjtimex
0x0000007d:mprotect
0x0000007e:sigprocmask
0x0000007f:create_module
0x00000080:init_module
0x00000081:delete_module
0x00000082:get_kernel_syms
0x00000083:quotactl
0x00000084:getpgid
0x00000085:fchdir
0x00000086:bdflush
0x00000087:sysfs
0x00000088:personality
0x00000089:afs_syscall
0x0000008a:setfsuid
0x0000008b:setfsgid
0x0000008c:_llseek
0x0000008d:getdents
0x0000008e:_newselect
0x0000008f:flock
0x00000090:msync
0x00000091:readv
0x00000092:writev
0x00000093:getsid
0x00000094:fdatasync
0x00000095:_sysctl
0x00000096:mlock
0x00000097:munlock
0x00000098:mlockall
0x00000099:munlockall
0x0000009a:sched_setparam
0x0000009b:sched_getparam
0x0000009c:sched_setscheduler
0x0000009d:sched_getscheduler
0x0000009e:sched_yield
0x0000009f:sched_get_priority_max
0x000000a0:sched_get_priority_min
0x000000a1:sched_rr_get_interval
0x000000a2:nanosleep
0x000000a3:mremap
0x000000a4:setresuid
0x000000a5:getresuid
0x000000a6:vm86
0x000000a7:query_module
0x000000a8:poll
0x000000a9:nfsservctl
0x000000aa:setresgid
0x000000ab:getresgid
0x000000ac:prctl
0x000000ad:rt_sigreturn
0x000000ae:rt_sigaction
0x000000af:rt_sigprocmask
0x000000b0:rt_sigpending
0x000000b1:rt_sigtimedwait
0x000000b2:rt_sigqueueinfo
0x000000b3:rt_sigsuspend
0x000000b4:pread64
0x000000b5:pwrite64
0x000000b6:chown
0x000000b7:getcwd
0x000000b8:capget
0x000000b9:capset
0x000000ba:sigaltstack
0x000000bb:sendfile
0x000000bc:getpmsg
0x000000bd:putpmsg
0x000000be:vfork
0x000000bf:ugetrlimit
0x000000c0:mmap2
0x000000c1:truncate64
0x000000c2:ftruncate64
0x000000c3:linux_stat64
0x000000c4:linux_lstat64
0x000000c5:linux_fstat64
0x000000c6:lchown32
0x000000c7:getuid32
0x000000c8:getgid32
0x000000c9:geteuid32
0x000000ca:getegid32
0x000000cb:setreuid32
0x000000cc:setregid32
0x000000cd:getgroups32
0x000000ce:setgroups32
0x000000cf:fchown32
0x000000d0:setresuid32
0x000000d1:getresuid32
0x000000d2:setresgid32
0x000000d3:getresgid32
0x000000d4:chown32
0x000000d5:setuid32
0x000000d6:setgid32
0x000000d7:setfsuid32
0x000000d8:setfsgid32
0x000000d9:pivot_root
0x000000da:mincore
0x000000db:madvise
0x000000dc:getdents64
0x000000dd:fcntl64
0x000000e0:gettid
0x000000e1:readahead
0x000000e2:setxattr
0x000000e3:lsetxattr
0x000000e4:fsetxattr
0x000000e5:getxattr
0x000000e6:lgetxattr
0x000000e7:fgetxattr
0x000000e8:listxattr
0x000000e9:llistxattr
0x000000ea:flistxattr
0x000000eb:removexattr
0x000000ec:lremovexattr
0x000000ed:fremovexattr
0x000000ee:tkill
0x000000ef:sendfile64
0x000000f0:futex
0x000000f1:sched_setaffinity
0x000000f2:sched_getaffinity
0x000000f3:set_thread_area
0x000000f4:get_thread_area
0x000000f5:io_setup
0x000000f6:io_destroy
0x000000f7:io_getevents
0x000000f8:io_submit
0x000000f9:io_cancel
0x000000fa:fadvise64
0x000000fc:exit_group
0x000000fd:lookup_dcookie
0x000000fe:epoll_create
0x000000ff:epoll_ctl
0x00000100:epoll_wait
0x00000101:remap_file_pages
0x00000102:set_tid_address
0x00000103:timer_create
0x00000104:timer_settime
0x00000105:timer_gettime
0x00000106:timer_getoverrun
0x00000107:timer_delete
0x00000108:clock_settime
0x00000109:clock_gettime
0x0000010a:clock_getres
0x0000010b:clock_nanosleep
0x0000010c:statfs64
0x0000010d:fstatfs64
0x0000010e:tgkill
0x0000010f:utimes
0x00000110:fadvise64_64
0x00000111:vserver
0x00000112:mbind
0x00000113:get_mempolicy
0x00000114:set_mempolicy
0x00000115:mq_open
0x00000116:mq_unlink
0x00000117:mq_timedsend
0x00000118:mq_timedreceive
0x00000119:mq_notify
0x0000011a:mq_getsetattr
0x0000011b:kexec_load
0x0000011c:waitid
0x0000011e:add_key
0x0000011f:request_key
0x00000120:keyctl
0x00000121:ioprio_set
0x00000122:ioprio_get
0x00000123:inotify_init
0x00000124:inotify_add_watch
0x00000125:inotify_rm_watch
0x00000126:migrate_pages
0x00000127:openat
0x00000128:mkdirat
0x00000129:mknodat
0x0000012a:fchownat
0x0000012b:futimesat
0x0000012c:linux_fstatat64
0x0000012d:unlinkat
0x0000012e:renameat
0x0000012f:linkat
0x00000130:symlinkat
0x00000131:readlinkat
0x00000132:fchmodat
0x00000133:faccessat
0x00000134:pselect6
0x00000135:ppoll
0x00000136:unshare
0x00000137:set_robust_list
0x00000138:get_robust_list
0x00000139:splice
0x0000013a:sync_file_range
0x0000013b:tee
0x0000013c:vmsplice
0x0000013d:move_pages
0x0000013e:getcpu
0x0000013f:epoll_pwait
0x00000140:utimensat
0x00000141:signalfd
0x00000142:timerfd_create
0x00000143:eventfd
0x00000144:fallocate
0x00000145:timerfd_settime
0x00000146:timerfd_gettime
0x00000147:signalfd4
0x00000148:eventfd2
0x00000149:epoll_create1
0x0000014a:dup3
0x0000014b:pipe2
0x0000014c:inotify_init1
0x0000014d:preadv
0x0000014e:pwritev
0x0000014f:rt_tgsigqueueinfo
0x00000150:perf_event_open
0x00000151:recvmmsg
0x00000152:fanotify_init
0x00000153:fanotify_mark
0x00000154:prlimit64
0x00000155:name_to_handle_at
0x00000156:open_by_handle_at
0x00000157:clock_adjtime
0x00000158:syncfs
0x00000159:sendmmsg
0x0000015a:setns
0x0000015b:process_vm_readv
0x0000015c:process_vm_writev
0x0000015d:kcmp
0x0000015e:finit_module
0x0000015f:sched_setattr
0x00000160:sched_getattr
0x00000161:renameat2
0x00000162:seccomp
0x00000163:getrandom
0x00000164:memfd_create
0x00000165:bpf
0x00000166:execveat
0x00000167:socket
0x00000168:socketpair
0x00000169:bind
0x0000016a:connect
0x0000016b:listen
0x0000016c:accept4
0x0000016d:getsockopt
0x0000016e:setsockopt
0x0000016f:getsockname
0x00000170:getpeername
0x00000171:sendto
0x00000172:sendmsg
0x00000173:recvfrom
0x00000174:recvmsg
0x00000175:shutdown
0x00000176:userfaultfd
0x00000177:membarrier
0x00000178:mlock2
0x80000001:hop
0x80000002:hopf
0x80000003:readf
0x80000004:writef
0x80000005:detach
0x80000006:getdrives
0x80000007:frealpath4
0x80000008:frealpathat
0x80000009:rpc_schedule
0x8000000a:sysctl
0x8000000b:openpty
0x8000000c:fchdirat
0x8000000d:time64
0x8000000e:set_exception_handler
0x8000000f:get_exception_handler
0x80000010:set_library_listdef
0x80000011:debugtrap
0x80000012:lfutex
0x80000013:lseek64
0x80000014:lfutexexpr
0x80000015:lfutexlockexpr
0x80000016:mktty
0x80000017:raiseat
0x80000018:coredump
0x80000019:stime64
0x8000001e:utime64
0x80000036:ioctlf
0x8000003c:fsmode
0x8000004e:gettimeofday64
0x8000004f:settimeofday64
0x80000052:select64
0x80000056:maplibrary
0x80000068:setitimer64
0x80000069:getitimer64
0x8000008d:kreaddir
0x80000091:readvf
0x80000092:writevf
0x8000009e:rpc_service
0x800000a1:sched_rr_get_interval64
0x800000a2:nanosleep64
0x800000b1:rt_sigtimedwait64
0x800000b4:pread64f
0x800000b5:pwrite64f
0x800000c3:kstat
0x800000c4:klstat
0x800000c5:kfstat
0x800000dc:kreaddirf
0x80000104:timer_settime64
0x80000105:timer_gettime64
0x80000108:clock_settime64
0x80000109:clock_gettime64
0x8000010a:clock_getres64
0x8000010b:clock_nanosleep64
0x8000010f:utimes64
0x80000128:fmkdirat
0x80000129:fmknodat
0x8000012b:futimesat64
0x8000012c:kfstatat
0x8000012e:frenameat
0x80000130:fsymlinkat
0x80000131:freadlinkat
0x80000134:pselect6_64
0x80000135:ppoll64
0x80000140:utimensat64
0x80000144:fallocate64
0x80000145:timerfd_settime64
0x80000146:timerfd_gettime64
0x8000014d:preadvf
0x8000014e:pwritevf
0x80000151:recvmmsg64
