/* Copyright (c) 2019-2020 Griefer@Work                                       *
 *                                                                            *
 * This software is provided 'as-is', without any express or implied          *
 * warranty. In no event will the authors be held liable for any damages      *
 * arising from the use of this software.                                     *
 *                                                                            *
 * Permission is granted to anyone to use this software for any purpose,      *
 * including commercial applications, and to alter it and redistribute it     *
 * freely, subject to the following restrictions:                             *
 *                                                                            *
 * 1. The origin of this software must not be misrepresented; you must not    *
 *    claim that you wrote the original software. If you use this software    *
 *    in a product, an acknowledgement (see the following) in the product     *
 *    documentation is required:                                              *
 *    Portions Copyright (c) 2019-2020 Griefer@Work                           *
 * 2. Altered source versions must be plainly marked as such, and must not be *
 *    misrepresented as being the original software.                          *
 * 3. This notice may not be removed or altered from any source distribution. *
 */
#define I        "INSTR_0"
#define I_1      "INSTR_1B"
#define I_24     "INSTR_24B"
#define I_248    "INSTR_248B"
#define I_46     "INSTR_46B"
#define I_RM0_1  "INSTR_RM0_1"
#define I_RM0_24 "INSTR_RM0_24"
#define I_RM_1   "INSTR_RM_1B"
#define I_RM_24  "INSTR_RM_24B"
#define I_RM     "INSTR_RM"
#define I_RM_661 "INSTR_RM_661"
#define I_2      "INSTR_2B"
#define I_3      "INSTR_3B"
#define I_UNDEF  "INSTR_UNDEF"

/* TODO: These tables should really be auto-generated based on libdisasm.
 *       libdisasm has gotten may more love over time, and is much more
 *       complete than this list right here! */
local itab = {
	0x00 : I_RM,
	0x01 : I_RM,
	0x02 : I_RM,
	0x03 : I_RM,
	0x04 : I_1,
	0x05 : I_24,

	0x06 : I,
	0x07 : I,

	0x08 : I_RM,
	0x09 : I_RM,
	0x0a : I_RM,
	0x0b : I_RM,
	0x0c : I_1,
	0x0d : I_24,

	0x0e : I,
	0x0f : I,

	0x10 : I_RM,
	0x11 : I_RM,
	0x12 : I_RM,
	0x13 : I_RM,
	0x14 : I_1,
	0x15 : I_24,

	0x16 : I,
	0x17 : I,

	0x18 : I_RM,
	0x19 : I_RM,
	0x1a : I_RM,
	0x1b : I_RM,
	0x1c : I_1,
	0x1d : I_24,

	0x1e : I,
	0x1f : I,

	0x20 : I_RM,
	0x21 : I_RM,
	0x22 : I_RM,
	0x23 : I_RM,
	0x24 : I_1,
	0x25 : I_24,

	0x26 : I,
	0x27 : I,

	0x28 : I_RM,
	0x29 : I_RM,
	0x2a : I_RM,
	0x2b : I_RM,
	0x2c : I_1,
	0x2d : I_24,

	0x2e : I,
	0x2f : I,

	0x30 : I_RM,
	0x31 : I_RM,
	0x32 : I_RM,
	0x33 : I_RM,
	0x34 : I_1,
	0x35 : I_24,

	0x36 : I,
	0x37 : I,

	0x38 : I_RM,
	0x39 : I_RM,
	0x3a : I_RM,
	0x3b : I_RM,
	0x3c : I_1,
	0x3d : I_24,

	0x3e : I,
	0x3f : I,

	0x40 : I,
	0x41 : I,
	0x42 : I,
	0x43 : I,
	0x44 : I,
	0x45 : I,
	0x46 : I,
	0x47 : I,
	0x48 : I,
	0x49 : I,
	0x4a : I,
	0x4b : I,
	0x4c : I,
	0x4d : I,
	0x4e : I,
	0x4f : I,

	0x50 : I,
	0x51 : I,
	0x52 : I,
	0x53 : I,
	0x54 : I,
	0x55 : I,
	0x56 : I,
	0x57 : I,
	0x58 : I,
	0x59 : I,
	0x5a : I,
	0x5b : I,
	0x5c : I,
	0x5d : I,
	0x5e : I,
	0x5f : I,

	0x60 : I,
	0x61 : I,

	0x62 : I_RM,

	0x63 : I_RM,

	/* 0x64 -- PREFIX */
	/* 0x65 -- PREFIX */
	/* 0x66 -- PREFIX */
	/* 0x67 -- PREFIX */

	0x68 : I_24,
	0x6a : I_1,

	0x6b : I_RM_1,

	0x6c : I,
	0x6d : I,
	0x6e : I,
	0x6f : I,

	0x70 : I_1,
	0x71 : I_1,
	0x72 : I_1,
	0x73 : I_1,
	0x74 : I_1,
	0x75 : I_1,
	0x76 : I_1,
	0x77 : I_1,
	0x78 : I_1,
	0x79 : I_1,
	0x7a : I_1,
	0x7b : I_1,
	0x7c : I_1,
	0x7d : I_1,
	0x7e : I_1,
	0x7f : I_1,

	0x80 : I_RM_1,
	0x81 : I_RM_24,
	0x82 : I_RM_1,
	0x83 : I_RM_1,

	0x84 : I_RM,
	0x85 : I_RM,

	0x86 : I_RM,
	0x87 : I_RM,

	0x88 : I_RM,
	0x89 : I_RM,
	0x8a : I_RM,
	0x8b : I_RM,
	0x8c : I_RM,
	0x8d : I_RM,
	0x8e : I_RM,
	0x8f : I_RM,

	0x90 : I,
	0x91 : I,
	0x92 : I,
	0x93 : I,
	0x94 : I,
	0x95 : I,
	0x96 : I,
	0x97 : I,

	0x98 : I,
	0x99 : I,
	0x9a : I_46,
	0x9b : I,
	0x9c : I,
	0x9d : I,
	0x9e : I,
	0x9f : I,

	0xa0 : I_1,
	0xa1 : I_248,
	0xa2 : I_1,
	0xa3 : I_248,

	0xa4 : I,
	0xa5 : I,
	0xa6 : I,
	0xa7 : I,

	0xa8 : I_1,
	0xa9 : I_24,

	0xaa : I,
	0xab : I,
	0xac : I,
	0xad : I,
	0xae : I,
	0xaf : I,

	0xb0 : I_1,
	0xb1 : I_1,
	0xb2 : I_1,
	0xb3 : I_1,
	0xb4 : I_1,
	0xb5 : I_1,
	0xb6 : I_1,
	0xb7 : I_1,

	0xb8 : I_248,
	0xb9 : I_248,
	0xba : I_248,
	0xbb : I_248,
	0xbc : I_248,
	0xbd : I_248,
	0xbe : I_248,
	0xbf : I_248,

	0xc0 : I_RM_1,
	0xc1 : I_RM_1,

	0xc2 : I_2,
	0xc3 : I,

	0xc4 : I_RM,
	0xc5 : I_RM,

	0xc6 : I_1,
	0xc7 : I_24,

	0xc8 : I_3,
	0xc9 : I,

	0xca : I_2,
	0xcb : I,
	0xcc : I,
	0xcd : I_1,
	0xce : I,
	0xcf : I,

	0xd0 : I_RM,
	0xd1 : I_RM,
	0xd2 : I_RM,
	0xd3 : I_RM,

	0xd4 : I_1,
	0xd5 : I_1,
	0xd6 : I,
	0xd7 : I,

	0xd8 : I_RM,
	0xd9 : I_RM,
	0xda : I_RM,
	0xdb : I_RM,
	0xdc : I_RM,
	0xdd : I_RM,
	0xde : I_RM,
	0xdf : I_RM,

	0xe0 : I_1,
	0xe1 : I_1,
	0xe2 : I_1,
	0xe3 : I_1,

	0xe4 : I,
	0xe5 : I,
	0xe6 : I_1,
	0xe7 : I_1,
	0xe8 : I_24,
	0xe9 : I_24,
	0xea : I_46,
	0xeb : I_1,
	0xec : I,
	0xed : I,
	0xee : I,
	0xef : I,

	/* 0xf0 -- PREFIX */

	0xf1 : I,

	/* 0xf2 -- PREFIX */
	/* 0xf3 -- PREFIX */

	0xf4 : I,
	0xf5 : I,
	0xf6 : I_RM0_1,
	0xf7 : I_RM0_24,

	0xf8 : I,
	0xf9 : I,
	0xfa : I,
	0xfb : I,
	0xfc : I,
	0xfd : I,
	0xfe : I_RM,
	0xff : I_RM,

};

local itab_0f = {
	0x00 : I_RM,
	0x01 : I_RM,
	0x02 : I_RM,
	0x03 : I_RM,

	0x05 : I,
	0x06 : I,
	0x07 : I,
	0x08 : I,
	0x09 : I,

	0x0b : I,

	0x0d : I_RM,

	0x10 : I_RM,
	0x11 : I_RM,
	0x12 : I_RM,
	0x13 : I_RM,
	0x14 : I_RM,
	0x15 : I_RM,
	0x16 : I_RM,
	0x17 : I_RM,

	0x18 : I_RM,

	0x1a : I_RM,
	0x1b : I_RM,
	0x1c : I_RM,

	0x1f : I_RM,

	0x20 : I_RM,
	0x21 : I_RM,
	0x22 : I_RM,
	0x23 : I_RM,

	0x24 : I_RM,
	0x26 : I_RM,

	0x28 : I_RM,
	0x29 : I_RM,
	0x2a : I_RM,
	0x2b : I_RM,
	0x2c : I_RM,
	0x2d : I_RM,
	0x2e : I_RM,
	0x2f : I_RM,

	0x30 : I,
	0x31 : I,
	0x32 : I,
	0x33 : I,
	0x34 : I,
	0x35 : I,

	0x37 : I,

	/* 0x38 -- PREFIX */
	/* 0x3a -- PREFIX */

	0x3f : I,

	0x40 : I_RM,
	0x41 : I_RM,
	0x42 : I_RM,
	0x43 : I_RM,
	0x44 : I_RM,
	0x45 : I_RM,
	0x46 : I_RM,
	0x47 : I_RM,
	0x48 : I_RM,
	0x49 : I_RM,
	0x4a : I_RM,
	0x4b : I_RM,
	0x4c : I_RM,
	0x4d : I_RM,
	0x4e : I_RM,
	0x4f : I_RM,

	0x50 : I_RM,
	0x51 : I_RM,
	0x52 : I_RM,
	0x53 : I_RM,
	0x54 : I_RM,
	0x55 : I_RM,
	0x56 : I_RM,
	0x57 : I_RM,
	0x58 : I_RM,
	0x59 : I_RM,
	0x5a : I_RM,
	0x5b : I_RM,
	0x5c : I_RM,
	0x5d : I_RM,
	0x5e : I_RM,
	0x5f : I_RM,

	0x60 : I_RM,
	0x61 : I_RM,
	0x62 : I_RM,
	0x63 : I_RM,
	0x64 : I_RM,
	0x65 : I_RM,
	0x66 : I_RM,
	0x67 : I_RM,
	0x68 : I_RM,
	0x69 : I_RM,
	0x6a : I_RM,
	0x6b : I_RM,
	0x6c : I_RM,
	0x6d : I_RM,
	0x6e : I_RM,
	0x6f : I_RM,

	0x70 : I_RM_1,

	0x71 : I_RM_1,
	0x72 : I_RM_1,
	0x73 : I_RM_1,

	0x74 : I_RM,
	0x75 : I_RM,
	0x76 : I_RM,
	0x77 : I_RM,
	0x78 : I_RM,
	0x79 : I_RM,

	0x7c : I_RM,
	0x7d : I_RM,
	0x7e : I_RM,
	0x7f : I_RM,

	0x80 : I_24,
	0x81 : I_24,
	0x82 : I_24,
	0x83 : I_24,
	0x84 : I_24,
	0x85 : I_24,
	0x86 : I_24,
	0x87 : I_24,
	0x88 : I_24,
	0x89 : I_24,
	0x8a : I_24,
	0x8b : I_24,
	0x8c : I_24,
	0x8d : I_24,
	0x8e : I_24,
	0x8f : I_24,

	0x90 : I_RM,
	0x91 : I_RM,
	0x92 : I_RM,
	0x93 : I_RM,
	0x94 : I_RM,
	0x95 : I_RM,
	0x96 : I_RM,
	0x97 : I_RM,
	0x98 : I_RM,
	0x99 : I_RM,
	0x9a : I_RM,
	0x9b : I_RM,
	0x9c : I_RM,
	0x9d : I_RM,
	0x9e : I_RM,
	0x9f : I_RM,

	0xa0 : I,
	0xa1 : I,
	0xa2 : I,
	0xa3 : I_RM,
	0xa4 : I_RM_1,
	0xa5 : I_RM,

	0xa8 : I,
	0xa9 : I,

	0xaa : I,

	0xab : I_RM,
	0xac : I_RM_1,
	0xad : I_RM,
	0xae : I_RM,
	0xaf : I_RM,

	0xb0 : I_RM,
	0xb1 : I_RM,

	0xb2 : I_RM,

	0xb3 : I_RM,

	0xb4 : I_RM,
	0xb5 : I_RM,

	0xb6 : I_RM,
	0xb7 : I_RM,
	0xb8 : I_RM,

	0xb9 : I_RM,

	0xba : I_RM_1,
	0xbb : I_RM,
	0xbc : I_RM,
	0xbd : I_RM,
	0xbe : I_RM,
	0xbf : I_RM,
	0xc0 : I_RM,
	0xc1 : I_RM,

	0xc2 : I_RM_1,
	0xc3 : I_RM,
	0xc4 : I_RM_1,
	0xc5 : I_RM_1,
	0xc6 : I_RM_1,

	0xc7 : I_RM,

	0xc8 : I,
	0xc9 : I,
	0xca : I,
	0xcb : I,
	0xcc : I,
	0xcd : I,
	0xce : I,
	0xcf : I,

	0xd0 : I_RM,
	0xd1 : I_RM,
	0xd2 : I_RM,
	0xd3 : I_RM,
	0xd4 : I_RM,
	0xd5 : I_RM,
	0xd6 : I_RM,
	0xd7 : I_RM,
	0xd8 : I_RM,
	0xd9 : I_RM,
	0xda : I_RM,
	0xdb : I_RM,
	0xdc : I_RM,
	0xdd : I_RM,
	0xde : I_RM,
	0xdf : I_RM,

	0xe0 : I_RM,
	0xe1 : I_RM,
	0xe2 : I_RM,
	0xe3 : I_RM,
	0xe4 : I_RM,
	0xe5 : I_RM,
	0xe6 : I_RM,
	0xe7 : I_RM,
	0xe8 : I_RM,
	0xe9 : I_RM,
	0xea : I_RM,
	0xeb : I_RM,
	0xec : I_RM,
	0xed : I_RM,
	0xee : I_RM,
	0xef : I_RM,

	0xf0 : I_RM,
	0xf1 : I_RM,
	0xf2 : I_RM,
	0xf3 : I_RM,
	0xf4 : I_RM,
	0xf5 : I_RM,
	0xf6 : I_RM,
	0xf7 : I_RM,
	0xf8 : I_RM,
	0xf9 : I_RM,
	0xfa : I_RM,
	0xfb : I_RM,
	0xfc : I_RM,
	0xfd : I_RM,
	0xfe : I_RM,
	0xff : I_RM,

};

local itab_0f38 = {

	0x00 : I_RM,
	0x01 : I_RM,
	0x02 : I_RM,
	0x03 : I_RM,
	0x04 : I_RM,
	0x05 : I_RM,
	0x06 : I_RM,
	0x07 : I_RM,
	0x08 : I_RM,
	0x09 : I_RM,
	0x0a : I_RM,
	0x0b : I_RM,
	0x0c : I_RM,
	0x0d : I_RM,
	0x0e : I_RM,
	0x0f : I_RM,

	0x10 : I_RM,
	0x11 : I_RM,
	0x12 : I_RM,
	0x13 : I_RM_661,
	0x14 : I_RM,
	0x15 : I_RM,
	0x16 : I_RM,
	0x17 : I_RM,
	0x18 : I_RM,
	0x19 : I_RM,
	0x1a : I_RM,
	0x1b : I_RM,
	0x1c : I_RM,
	0x1d : I_RM,
	0x1e : I_RM,
	0x1f : I_RM,

	0x20 : I_RM,
	0x21 : I_RM,
	0x22 : I_RM,
	0x23 : I_RM,
	0x24 : I_RM,
	0x25 : I_RM,

	0x28 : I_RM,
	0x29 : I_RM,
	0x2a : I_RM,
	0x2b : I_RM,
	0x2c : I_RM,
	0x2d : I_RM,
	0x2e : I_RM,
	0x2f : I_RM,

	0x30 : I_RM,
	0x31 : I_RM,
	0x32 : I_RM,
	0x33 : I_RM,
	0x34 : I_RM,
	0x35 : I_RM,
	0x36 : I_RM,
	0x37 : I_RM,
	0x38 : I_RM,
	0x39 : I_RM,
	0x3a : I_RM,
	0x3b : I_RM,
	0x3c : I_RM,
	0x3d : I_RM,
	0x3e : I_RM,
	0x3f : I_RM,

	0x40 : I_RM,
	0x41 : I_RM,

	0x45 : I_RM,
	0x46 : I_RM,
	0x47 : I_RM,

	0x58 : I_RM,
	0x59 : I_RM,
	0x5a : I_RM,

	0x78 : I_RM,
	0x79 : I_RM,

	0x80 : I_RM,
	0x81 : I_RM,
	0x82 : I_RM,

	0x8c : I_RM,

	0x8e : I_RM,

	0x90 : I_RM,
	0x91 : I_RM,
	0x92 : I_RM,
	0x93 : I_RM,

	0x96 : I_RM,
	0x97 : I_RM,
	0x98 : I_RM,
	0x99 : I_RM,
	0x9a : I_RM,
	0x9b : I_RM,
	0x9c : I_RM,
	0x9d : I_RM,
	0x9e : I_RM,
	0x9f : I_RM,

	0xa6 : I_RM,
	0xa7 : I_RM,
	0xa8 : I_RM,
	0xa9 : I_RM,
	0xaa : I_RM,
	0xab : I_RM,
	0xac : I_RM,
	0xad : I_RM,
	0xae : I_RM,
	0xaf : I_RM,

	0xb6 : I_RM,
	0xb7 : I_RM,
	0xb8 : I_RM,
	0xb9 : I_RM,
	0xba : I_RM,
	0xbb : I_RM,
	0xbc : I_RM,
	0xbd : I_RM,
	0xbe : I_RM,
	0xbf : I_RM,

	0xc8 : I_RM,
	0xc9 : I_RM,
	0xca : I_RM,
	0xcb : I_RM,
	0xcc : I_RM,
	0xcd : I_RM,

	0xdb : I_RM,
	0xdc : I_RM,
	0xdd : I_RM,
	0xde : I_RM,
	0xdf : I_RM,

	0xf0 : I_RM,
	0xf1 : I_RM,
	0xf2 : I_RM,
	0xf3 : I_RM,

	0xf5 : I_RM,
	0xf6 : I_RM,
	0xf7 : I_RM,

};

local itab_0f3a = {
	0x00 : I_RM_1,
	0x01 : I_RM_1,
	0x02 : I_RM_1,

	0x04 : I_RM_1,
	0x05 : I_RM_1,
	0x06 : I_RM_1,

	0x08 : I_RM_1,
	0x09 : I_RM_1,
	0x0a : I_RM_1,
	0x0b : I_RM_1,
	0x0c : I_RM_1,
	0x0d : I_RM_1,
	0x0e : I_RM_1,
	0x0f : I_RM_1,

	0x14 : I_RM_1,
	0x15 : I_RM_1,
	0x16 : I_RM_1,
	0x17 : I_RM_1,
	0x18 : I_RM_1,
	0x19 : I_RM_1,

	0x1d : I_RM_1,

	0x20 : I_RM_1,
	0x21 : I_RM_1,
	0x22 : I_RM_1,

	0x38 : I_RM_1,
	0x39 : I_RM_1,

	0x40 : I_RM_1,
	0x41 : I_RM_1,
	0x42 : I_RM_1,

	0x44 : I_RM_1,

	0x46 : I_RM_1,

	0x4a : I_RM,
	0x4b : I_RM,
	0x4c : I_RM,

	0x60 : I_RM_1,
	0x61 : I_RM_1,
	0x62 : I_RM_1,
	0x63 : I_RM_1,

	0xcc : I_RM_1,

	0xdf : I_RM_1,

	0xf0 : I_RM_1,
};



















